# react 和 vue 技术栈总结

1. react 和 vue 变更状态方式不同

react 是通过调用`this.setState()`这个函数去执行的，vue 是可以直接用`this.xxx = xxx`赋值的形式去改变。

react 整体是函数式的思想，把组件设计成纯组件，状态和逻辑通过参数传入，是单向数据流。在`setState`之后会重新渲染，你可以在`shouldComponentUpdate`这个生命周期中优化（状态没有发生改变的话，返回`false`，可以不进行`render`）`React.PureComponent`以浅层对比`prop`和`state`的方式实现了`shouldComponentUpdate()`。`setState()`是异步的，react 做了优化（什么优化呢，我还没看源码）调用的时候就要注意一下。

**展开：`React.PureComponent`**
它只是在数据比较简单的情况下才有效，如果数据结构复杂，那么会出现，你希望他重新`render()`，但是它没有，`react`提供了一个`forceUpdate()`方法，可以强制让组件重新渲染，这个方法会跳过该组件的`shouldComponentUpdate()`方法，但它的子组件会触发正常的生命周期，包括`shouldComponentUpdate()`方法，如果返回`true`，那么`React`仍然会更新`Dom`。

vue 的思想是响应式的，它的数据是可变的，可以被重新赋值，重新赋值是会触发属性的`setter`方法，然后触发`Watcher`的监听，然后就会调用`update()`，去更新`view`，更新的这个中间是会 diff 算法去对比前后两次的变化，把变化的那部分做更新处理。状态发生改变的时候，vue 是会去判断，前后两个数据是否真的发生改变了，如果是同一个值，那么是不会去调用`updata()`这个方法的，这个是 vue 帮我们做的事情。

从极端角度考虑问题的话，vue 是对传入的数据做了` getter``setter `的监听，那么如果数据很多，状态很庞大的话，vue 处理起来就会出现卡顿，而 react 是让开发者自己去优化和控制的，所以大型应用选择 react 会更自在一点，当然也更考验开发者的能力。

2. react 和 vue 的编写方式不同

react 是用 jsx 的方式来编写的，所有的都是通过 js 写的，html 也都放在 js 里面，包括 css 也可以（我没用过，在别的地方有看到过，`styled-component`）。

vue 的话是分成三块，我觉得跟 jquery 时代比较像，html 是包裹在`<template></template>`标签里面，js 是包裹在`<script></script>`标签里面，css 是包裹在`<style></style>`，集中在一起，当然也是可以分开的，我个人觉得这种方式写组件会挺方便的，不需要文件跳来跳去的，只需要在一个文件里面操作就可以，也方便以后的维护，关于组件的东西都在这个文件里头，简单。

vue 还有可视化搭建，就很方便，傻瓜式操作，他还是中国人写的，学习资料都是中文，学习起来就更简单一些。
vue 也内置了很多功能，帮开发者做了很多事情，追求简单开发（到底做了多少不留名的好事，我也要去看源码学习一下）。
个人感觉 vue 的语法好多（也可能是我近期用的 react 多一点，vue 的语法都忘记了，就感觉 vue 语法多吧）

比如 react 和 vue 的父子组件的传值

父组件-->子组件 都是父组件传下来的 props

子组件-->父组件 react 的话是调用`props.handerFun(xxx)`出去就可以了，也比较好理解，vue 的话需要调用`this.$emit('handerFun', xxx)`，需要转个弯

3. diff 算法的不同

vue 是双端对比，就是新旧数组，旧头对新头，旧尾对新尾，同时从新旧 children 的两端开始进行比较，借助 key 值找到可复用的节点，再进行相关操作。

react 是遍历新数组（旧：[a, b, c]， 新：[b, a, c]），第一个时`b`，在旧数组里面找自己，有的话，就拿旧数组中自己的位置（index = 1）和 lastIndex（开始时 0）做对比，如果旧数组的位置 < lastIndex 的话，旧数组里的自己（`b`)不用动，把 lastIndex 赋值为 1（index 和 lastIndex 取大），然后旧数组中的`b`的索引做个标记为 0，我这个`b`现在是要去 0 的位置上。（这样写好像将不明白，我要再花点时间，让自己能完全明白，然后再将给你们听吧）反正表现上，就是新数组遍历过去，然后旧数组上面的值，会向后移动到新的位置上。

示例：[a, b, c, d]-->[d, a, b, c]

===> 第一次遍历，d 这个值不需要做移动

===> 第二次遍历，a 移动到 d 后面 旧数组变成 [b, c, d, a]

===> 第三次遍历，b 移动到 a 后面 旧数组变成 [c, d, a, b]

===> 第四次遍历，c 移动到 b 后面 旧数组变成 [d, a, b, c]

react 需要移动三次，Vue 会在首尾对比时，只移动最后一个节点到第一位即可。相比 React 的 Diff 算法，同样情况下可以减少移动节点次数，减少不必要的性能损耗，更加的优雅。

从这个算法中，我们就可以去避免写一些垃圾代码。

以上都是我个人的理解，写错了，理解错误的地方，会在后续学习中不断的更新。

参考资料(要多研读几遍，才能把算法理解透彻)

- [React 源码剖析系列 － 不可思议的 react diff](https://zhuanlan.zhihu.com/p/20346379)
- [解析 vue2.0 的 diff 算法](https://segmentfault.com/a/1190000008782928)
