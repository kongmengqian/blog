# HTTP 缓存

> 2020.05.08 20:00

### 强缓存

不会向服务器请求，根据`expires`，`Cache-Control`来判断是否有过期，若命中缓存，则直接从本地缓存中读取。否则向服务器发送请求。

### 协商缓存

向服务器发送请求，服务器会根据请求头上的`If-modified-since`，`If-None-Match`来判断是否有被修改，是否过期，若命中缓存，则服务器会返回 304 状态码并带上新的 response header 通知浏览器从缓存中读取资源。若没有命中，服务器会返回 200 状态码和新的资源，浏览器会更新本地缓存。

### 常见开发场景

- **f5 刷新** - 浏览器将绕过本地缓存来发送请求到服务器, 此时, 协商缓存是有效的。
- **强制刷新(ctrl+f5**) - 浏览器不使用缓存，因此发送的请求头部均带有`Cache-control:no-cache`(为了兼容，还带了`Pragma:no-cache`),服务器直接返回 200 和最新内容。
- **清空浏览器缓存再访问** - 浏览器不使用缓存，会去请求服务器，然后返回新的资源和`code 200`，浏览器会缓存这个资源。
- **回车或转向** - 当在地址栏上输入回车或者按下跳转按钮的时候, 所有缓存都生效。

### 文章推荐

- [关于浏览器缓存你知道多少？](https://mp.weixin.qq.com/s/Wvc0lkLpgyEW_u7bbMdvpQ)(有两张图清晰的告知你服务器、浏览器、本地缓存之间的往来，看完秒懂)
- [HTTP 缓存一二三](https://zhuanlan.zhihu.com/p/29750583)(里面有一个浏览器、服务器、移动端三者的对话，特别形象的解释了 HTTP 缓存)
- [浏览器缓存](https://github.com/xiangxingchen/blog/issues/9)(在上面两篇文章的基础上，增加了 from disk cache（磁盘缓存）和 from memory cache（内存缓存）的解说，列举了用户不同的刷新行为对浏览器缓存的影响)
- [浅谈浏览器缓存](https://cloud.tencent.com/developer/article/1356696)(原理-实际情况-优化策略)
